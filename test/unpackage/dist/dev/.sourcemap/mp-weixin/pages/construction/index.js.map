{"version":3,"file":"index.js","sources":["pages/construction/index.vue","../../../Downloads/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29uc3RydWN0aW9uL2luZGV4LnZ1ZQ"],"sourcesContent":["<template>\r\n    <view class=\"page-container\">\r\n        <!-- Sidebar -->\r\n        <view class=\"sidebar\" :class=\"{ 'sidebar-hidden': !sidebarVisible }\">\r\n            <view class=\"sidebar-content\">\r\n                <view class=\"step-nav\"\r\n                    :class=\"{ active: currentStep === 'beforeCleaning', completed: isStepCompleted('beforeCleaning') }\"\r\n                    @click=\"goToStep('beforeCleaning')\">1. 清洗前状态</view>\r\n                <view class=\"step-nav\" data-step=\"afterCleaning\" :class=\"{ \r\n                        active: currentStep === 'afterCleaning', \r\n                        completed: isStepCompleted('afterCleaning'),\r\n                        locked: !isStepCompleted('beforeCleaning') && currentStep !== 'afterCleaning'\r\n                    }\" @click=\"goToStep('afterCleaning')\">\r\n                    2. 清洗后状态\r\n                    <text class=\"lock-icon\"\r\n                        v-if=\"!isStepCompleted('beforeCleaning') && currentStep !== 'afterCleaning'\">🔒</text>\r\n                </view>\r\n                <view class=\"step-nav\"\r\n                    :class=\"{ active: currentStep === 'workPhotos', completed: isStepCompleted('workPhotos') }\"\r\n                    @click=\"goToStep('workPhotos')\">3. 工作照</view>\r\n                <view class=\"step-nav\"\r\n                    :class=\"{ active: currentStep === 'environmentNotes', completed: isStepCompleted('environmentNotes') }\"\r\n                    @click=\"goToStep('environmentNotes')\">4. 环境变更</view>\r\n            </view>\r\n        </view>\r\n\r\n        <!-- Mini sidebar (when hidden) -->\r\n        <view class=\"mini-sidebar\" v-if=\"!sidebarVisible\">\r\n            <view class=\"mini-step\" @click=\"goToStep('beforeCleaning')\"\r\n                :class=\"{ active: currentStep === 'beforeCleaning', completed: isStepCompleted('beforeCleaning') }\">1\r\n            </view>\r\n            <view class=\"mini-step\" @click=\"goToStep('afterCleaning')\" :class=\"{ \r\n                      active: currentStep === 'afterCleaning', \r\n                      completed: isStepCompleted('afterCleaning'),\r\n                      locked: !isStepCompleted('beforeCleaning') && currentStep !== 'afterCleaning'\r\n                  }\">\r\n                2\r\n                <text class=\"mini-lock\"\r\n                    v-if=\"!isStepCompleted('beforeCleaning') && currentStep !== 'afterCleaning'\">🔒</text>\r\n            </view>\r\n            <view class=\"mini-step\" @click=\"goToStep('workPhotos')\"\r\n                :class=\"{ active: currentStep === 'workPhotos', completed: isStepCompleted('workPhotos') }\">3</view>\r\n            <view class=\"mini-step\" @click=\"goToStep('environmentNotes')\"\r\n                :class=\"{ active: currentStep === 'environmentNotes', completed: isStepCompleted('environmentNotes') }\">\r\n                4</view>\r\n        </view>\r\n\r\n        <!-- Sidebar toggle button -->\r\n        <view class=\"sidebar-toggle\" @click=\"sidebarVisible = !sidebarVisible\">\r\n            <text>{{ sidebarVisible ? '◀' : '▶' }}</text>\r\n        </view>\r\n\r\n        <!-- Main Content -->\r\n        <view class=\"main-content\" :class=\"{ 'content-expanded': !sidebarVisible }\">\r\n            <view class=\"container\">\r\n                <view class=\"form-section\">\r\n                    <view class=\"section-title\">清洗工作记录</view>\r\n\r\n                    <!-- Login status indicator -->\r\n                    <view class=\"login-status\">\r\n                        <text class=\"status-text\">已登录: {{userInfo.name}} ({{userInfo.company}})</text>\r\n                    </view>\r\n\r\n                    <!-- Step 1: 清洗前状态 -->\r\n                    <view v-if=\"currentStep === 'beforeCleaning'\">\r\n                        <view class=\"section-subtitle\">清洗前状态拍照</view>\r\n\r\n                        <!-- Photo upload for selected options -->\r\n                        <view class=\"selected-options\" v-if=\"selectedCleaningItems.length > 0\">\r\n                            <view class=\"selected-option\" v-for=\"item in selectedCleaningItems\" :key=\"item.id\">\r\n                                <view class=\"option-header\">\r\n                                    <text class=\"option-label\">{{ item.label }}</text>\r\n                                    <button class=\"remove-btn\" @click=\"removeCleaningItem(item.id)\">移除</button>\r\n                                </view>\r\n\r\n                                <!-- Sub-options selection for this area -->\r\n                                <view class=\"sub-options-section\">\r\n                                    <text class=\"sub-options-title\">选择{{ item.label }}具体部位</text>\r\n                                    <view class=\"sub-option-grid\">\r\n                                        <view class=\"sub-option-item\"\r\n                                            v-for=\"subOption in getSubOptionsForArea(item.value)\" :key=\"subOption.value\"\r\n                                            :class=\"{ selected: isSubOptionSelected(item.id, subOption.value) }\"\r\n                                            @click=\"toggleSubOption(item.id, subOption.value)\">\r\n                                            <text class=\"sub-option-text\">{{ subOption.label }}</text>\r\n                                            <view class=\"sub-option-checkbox\"\r\n                                                v-if=\"isSubOptionSelected(item.id, subOption.value)\">✓</view>\r\n                                        </view>\r\n                                    </view>\r\n                                </view>\r\n\r\n                                <!-- Photo upload for custom options (其他部位) -->\r\n                                <view class=\"custom-photo-section\" v-if=\"item.value.startsWith('custom_')\">\r\n                                    <text class=\"sub-photo-label\">{{ item.label }} 清洗前照片</text>\r\n                                    <view class=\"photo-upload-area\"\r\n                                        @click=\"uploadCustomOptionPhotos('before', item.value)\">\r\n                                        <text>点击上传 {{ item.label }} 清洗前照片</text>\r\n                                        <text class=\"photo-count\" v-if=\"getCustomPhotoCount('before', item.value)\">\r\n                                            已上传 {{ getCustomPhotoCount('before', item.value) }} 张\r\n                                        </text>\r\n                                    </view>\r\n                                </view>\r\n\r\n                                <!-- Photo upload for selected sub-options -->\r\n                                <view class=\"sub-photos-section\" v-if=\"getSelectedSubOptions(item.id).length > 0\">\r\n                                    <view class=\"sub-photo-item\" v-for=\"subOption in getSelectedSubOptions(item.id)\"\r\n                                        :key=\"subOption\">\r\n                                        <text class=\"sub-photo-label\">{{ getSubOptionLabel(item.value, subOption) }}\r\n                                            照片</text>\r\n                                        <view class=\"photo-upload-area\"\r\n                                            @click=\"uploadDetailedPhotos('before', item.id, subOption)\">\r\n                                            <text>点击上传 {{ getSubOptionLabel(item.value, subOption) }} 清洗前照片</text>\r\n                                            <text class=\"photo-count\"\r\n                                                v-if=\"getDetailedPhotoCount('before', item.id, subOption)\">\r\n                                                已上传 {{ getDetailedPhotoCount('before', item.id, subOption) }} 张\r\n                                            </text>\r\n                                        </view>\r\n                                    </view>\r\n                                </view>\r\n\r\n                                <!-- Side notes -->\r\n                                <view class=\"form-group\" style=\"margin-top: 20rpx;\">\r\n                                    <text class=\"label\">{{ item.label }} 其他备注</text>\r\n                                    <textarea class=\"textarea small-textarea\" :value=\"sideNotes[item.id] || ''\"\r\n                                        @input=\"updateSideNotes(item.id, $event)\" placeholder=\"请输入其他备注信息\"\r\n                                        rows=\"3\"></textarea>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n\r\n                        <!-- Main cleaning options selection at bottom -->\r\n                        <view class=\"cleaning-options\">\r\n                            <text class=\"options-title\">选择清洗部位</text>\r\n                            <view class=\"option-grid\">\r\n                                <view class=\"option-item\" v-for=\"option in cleaningOptions\" :key=\"option.value\"\r\n                                    @click=\"addCleaningOption(option.value)\">\r\n                                    <text class=\"option-text\">{{ option.label }}</text>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n\r\n                        <!-- Custom main option input -->\r\n                        <view class=\"form-group\" style=\"margin-top: 30rpx;\">\r\n                            <text class=\"label\">其他部位</text>\r\n                            <input class=\"input tall-input\" v-model=\"customBeforeOption\" placeholder=\"请输入其他需要清洗的部位\" />\r\n                            <button class=\"add-custom-btn\" @click=\"addCustomBeforeOption\"\r\n                                v-if=\"customBeforeOption.trim()\">添加</button>\r\n                        </view>\r\n\r\n                        <view class=\"button-group\">\r\n                            <button class=\"btn-save\" @click=\"goToStep('afterCleaning')\"\r\n                                :disabled=\"!isStepCompleted('beforeCleaning')\"\r\n                                :class=\"{ 'btn-disabled': !isStepCompleted('beforeCleaning') }\">\r\n                                下一步\r\n                            </button>\r\n                        </view>\r\n                    </view>\r\n\r\n                    <!-- Step 2: 清洗后状态 -->\r\n                    <view v-if=\"currentStep === 'afterCleaning'\">\r\n                        <view class=\"section-subtitle\">清洗后状态拍照</view>\r\n\r\n                        <!-- Show same options as selected in before cleaning -->\r\n                        <view class=\"cleaning-options\">\r\n                            <text class=\"options-title\">清洗后状态拍照 (基于清洗前选择)</text>\r\n                        </view>\r\n\r\n                        <!-- Photo upload for the same options selected in before cleaning -->\r\n                        <view class=\"selected-options\" v-if=\"selectedCleaningItems.length > 0\">\r\n                            <view class=\"selected-option\" v-for=\"item in selectedCleaningItems\" :key=\"item.id\">\r\n                                <text class=\"option-label\">{{ item.label }} 清洗后照片</text>\r\n\r\n                                <!-- Side notes display (read-only) -->\r\n                                <view class=\"form-group\" v-if=\"sideNotes[item.id] && sideNotes[item.id].trim()\"\r\n                                    style=\"margin-bottom: 20rpx;\">\r\n                                    <text class=\"label\">备注信息</text>\r\n                                    <view class=\"notes-display\">{{ sideNotes[item.id] }}</view>\r\n                                </view>\r\n\r\n                                <!-- Photo upload for custom options in after cleaning -->\r\n                                <view class=\"custom-photo-section\" v-if=\"item.value.startsWith('custom_')\">\r\n                                    <text class=\"sub-photo-label\">{{ item.label }} 清洗后照片</text>\r\n                                    <view class=\"photo-upload-area\"\r\n                                        @click=\"uploadCustomOptionPhotos('after', item.value)\">\r\n                                        <text>点击上传 {{ item.label }} 清洗后照片</text>\r\n                                        <text class=\"photo-count\" v-if=\"getCustomPhotoCount('after', item.value)\">\r\n                                            已上传 {{ getCustomPhotoCount('after', item.value) }} 张\r\n                                        </text>\r\n                                    </view>\r\n                                </view>\r\n\r\n                                <!-- Photo upload for selected sub-options (based on before cleaning) -->\r\n                                <view class=\"sub-photos-section\" v-if=\"getSelectedSubOptions(item.id).length > 0\">\r\n                                    <view class=\"sub-photo-item\" v-for=\"subOption in getSelectedSubOptions(item.id)\"\r\n                                        :key=\"subOption\">\r\n                                        <text class=\"sub-photo-label\">{{ getSubOptionLabel(item.value, subOption) }}\r\n                                            清洗后照片</text>\r\n                                        <view class=\"photo-upload-area\"\r\n                                            @click=\"uploadDetailedPhotos('after', item.id, subOption)\">\r\n                                            <text>点击上传 {{ getSubOptionLabel(item.value, subOption) }} 清洗后照片</text>\r\n                                            <text class=\"photo-count\"\r\n                                                v-if=\"getDetailedPhotoCount('after', item.id, subOption)\">\r\n                                                已上传 {{ getDetailedPhotoCount('after', item.id, subOption) }} 张\r\n                                            </text>\r\n                                        </view>\r\n                                    </view>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n\r\n                        <view class=\"button-group\">\r\n                            <button class=\"btn-secondary\" @click=\"goToStep('beforeCleaning')\">上一步</button>\r\n                            <button class=\"btn-save\" @click=\"goToStep('workPhotos')\"\r\n                                :disabled=\"!isAfterCleaningComplete()\">下一步</button>\r\n                        </view>\r\n                    </view>\r\n\r\n                    <!-- Step 3: 工作照 -->\r\n                    <view v-if=\"currentStep === 'workPhotos'\">\r\n                        <view class=\"section-subtitle\">工作照拍摄</view>\r\n\r\n                        <view class=\"photo-upload-section\">\r\n                            <text class=\"label\">上传工作照片</text>\r\n                            <view class=\"photo-upload-area\" @click=\"uploadWorkPhotos\">\r\n                                <text>点击上传工作照片</text>\r\n                                <text class=\"photo-count\" v-if=\"workPhotos.length\">\r\n                                    已上传 {{ workPhotos.length }} 张\r\n                                </text>\r\n                            </view>\r\n                        </view>\r\n\r\n                        <view class=\"button-group\">\r\n                            <button class=\"btn-secondary\" @click=\"goToStep('afterCleaning')\">上一步</button>\r\n                            <button class=\"btn-save\" @click=\"goToStep('environmentNotes')\">下一步</button>\r\n                        </view>\r\n                    </view>\r\n\r\n                    <!-- Step 4: 环境变更记录 -->\r\n                    <view v-if=\"currentStep === 'environmentNotes'\">\r\n                        <view class=\"section-subtitle\">环境变更记录</view>\r\n\r\n                        <view class=\"form-group\">\r\n                            <text class=\"label\">环境变更记录</text>\r\n                            <textarea class=\"textarea\" v-model=\"environmentNotes\" placeholder=\"请记录环境变更情况、特殊注意事项等\"\r\n                                rows=\"8\"></textarea>\r\n                        </view>\r\n\r\n                        <view class=\"button-group\">\r\n                            <button class=\"btn-secondary\" @click=\"goToStep('workPhotos')\">上一步</button>\r\n                            <button class=\"btn-save\" @click=\"saveCleaningRecord\">保存记录</button>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n            </view>\r\n        </view>\r\n    </view>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        data() {\r\n            return {\r\n                currentStep: 'beforeCleaning',\r\n                sidebarVisible: true,\r\n\r\n                // Cleaning options\r\n                cleaningOptions: [{\r\n                        value: 'kitchen',\r\n                        label: '厨房'\r\n                    },\r\n                    {\r\n                        value: 'pipe',\r\n                        label: '管道'\r\n                    },\r\n                    {\r\n                        value: 'fan',\r\n                        label: '风机'\r\n                    },\r\n                    {\r\n                        value: 'purifier',\r\n                        label: '净化器'\r\n                    }\r\n                ],\r\n\r\n                // Sub-options for each cleaning area (removed 其他)\r\n                cleaningSubOptions: {\r\n                    kitchen: [{\r\n                            value: 'environment',\r\n                            label: '环境'\r\n                        },\r\n                        {\r\n                            value: 'stove',\r\n                            label: '灶台'\r\n                        },\r\n                        {\r\n                            value: 'hood',\r\n                            label: '烟罩'\r\n                        },\r\n                        {\r\n                            value: 'grease_filter',\r\n                            label: '油篦子'\r\n                        },\r\n                        {\r\n                            value: 'hood_pipe',\r\n                            label: '烟罩横管'\r\n                        }\r\n                    ],\r\n                    pipe: [{\r\n                            value: 'pipe_environment',\r\n                            label: '管道环境'\r\n                        },\r\n                        {\r\n                            value: 'pipe_leak',\r\n                            label: '管道漏油'\r\n                        },\r\n                        {\r\n                            value: 'damage_points',\r\n                            label: '破损点'\r\n                        }\r\n                    ],\r\n                    fan: [{\r\n                            value: 'location_environment',\r\n                            label: '环境位置'\r\n                        },\r\n                        {\r\n                            value: 'appearance',\r\n                            label: '外观'\r\n                        },\r\n                        {\r\n                            value: 'fan_impeller',\r\n                            label: '风机叶轮'\r\n                        },\r\n                        {\r\n                            value: 'exhaust_outlet',\r\n                            label: '排风口'\r\n                        }\r\n                    ],\r\n                    purifier: [{\r\n                            value: 'location_environment',\r\n                            label: '位置环境'\r\n                        },\r\n                        {\r\n                            value: 'appearance',\r\n                            label: '外观'\r\n                        },\r\n                        {\r\n                            value: 'electric_field',\r\n                            label: '电场'\r\n                        }\r\n                    ]\r\n                },\r\n\r\n                // Photos for custom options (其他部位)\r\n                customOptionPhotos: {\r\n                    before: {}, // { custom_123456: [photo1, photo2] }\r\n                    after: {}\r\n                },\r\n\r\n                // Selected cleaning items - now supports multiple of same type\r\n                selectedCleaningItems: [], // Array of objects: [{id: unique_id, value: 'kitchen', label: '厨房'}]\r\n                customBeforeOption: '',\r\n\r\n                // Selected sub-options for each item (using unique IDs)\r\n                selectedSubOptions: {}, // { item_id: ['environment', 'stove'] }\r\n\r\n                // Side notes for each item (using unique IDs)\r\n                sideNotes: {}, // { item_id: 'some notes' }\r\n\r\n                // Detailed photos organized by item ID and sub-option\r\n                detailedBeforePhotos: {}, // { item_id: { environment: [photos], stove: [photos] } }\r\n                detailedAfterPhotos: {},\r\n\r\n                workPhotos: [],\r\n                environmentNotes: '',\r\n\r\n                userInfo: {\r\n                    name: uni.getStorageSync('userName') || '未知用户',\r\n                    company: uni.getStorageSync('userCompany') || '未知公司'\r\n                }\r\n            };\r\n        },\r\n\r\n        onLoad() {\r\n            // TEMPORARY: Clear data on each load during development\r\n            uni.removeStorageSync('cleaningData');\r\n\r\n            // Load any saved data (should be empty now)\r\n            this.loadSavedData();\r\n        },\r\n\r\n        methods: {\r\n            // Step navigation with locking\r\n            goToStep(step) {\r\n                // Check if trying to access step 2 (afterCleaning)\r\n                if (step === 'afterCleaning') {\r\n                    // Only allow if step 1 is completed\r\n                    if (!this.isStepCompleted('beforeCleaning')) {\r\n                        uni.showToast({\r\n                            title: '请先完成清洗前状态拍照',\r\n                            icon: 'none',\r\n                            duration: 2000\r\n                        });\r\n                        return; // Block access\r\n                    }\r\n                }\r\n\r\n                // Allow access to all other steps (beforeCleaning, workPhotos, environmentNotes)\r\n                this.currentStep = step;\r\n            },\r\n\r\n            // Add cleaning option (allows multiple of same type)\r\n            addCleaningOption(value) {\r\n                const uniqueId = Date.now() + '_' + Math.random();\r\n                const option = this.cleaningOptions.find(opt => opt.value === value);\r\n\r\n                const newItem = {\r\n                    id: uniqueId,\r\n                    value: value,\r\n                    label: option.label\r\n                };\r\n\r\n                this.selectedCleaningItems.push(newItem);\r\n\r\n                // Initialize arrays for this specific item\r\n                this.$set(this.selectedSubOptions, uniqueId, []);\r\n                this.$set(this.detailedBeforePhotos, uniqueId, {});\r\n                this.$set(this.detailedAfterPhotos, uniqueId, {});\r\n                this.$set(this.sideNotes, uniqueId, '');\r\n            },\r\n\r\n            // Remove cleaning item\r\n            removeCleaningItem(itemId) {\r\n                const index = this.selectedCleaningItems.findIndex(item => item.id === itemId);\r\n                if (index > -1) {\r\n                    this.selectedCleaningItems.splice(index, 1);\r\n                    delete this.selectedSubOptions[itemId];\r\n                    delete this.detailedBeforePhotos[itemId];\r\n                    delete this.detailedAfterPhotos[itemId];\r\n                    delete this.sideNotes[itemId];\r\n                }\r\n            },\r\n\r\n            // Add custom option\r\n            addCustomBeforeOption() {\r\n                if (this.customBeforeOption.trim()) {\r\n                    const customValue = 'custom_' + Date.now();\r\n                    this.cleaningOptions.push({\r\n                        value: customValue,\r\n                        label: this.customBeforeOption.trim()\r\n                    });\r\n\r\n                    // Add the custom option as a selected item\r\n                    this.addCleaningOption(customValue);\r\n                    this.customBeforeOption = '';\r\n                    this.$set(this.customOptionPhotos.before, customValue, []);\r\n                    this.$set(this.customOptionPhotos.after, customValue, []);\r\n                }\r\n            },\r\n\r\n            // Get sub-options for a specific area\r\n            getSubOptionsForArea(area) {\r\n                return this.cleaningSubOptions[area] || [];\r\n            },\r\n\r\n            // Check if sub-option is selected\r\n            isSubOptionSelected(itemId, subOption) {\r\n                return this.selectedSubOptions[itemId] && this.selectedSubOptions[itemId].includes(subOption);\r\n            },\r\n\r\n            // Toggle sub-option selection\r\n            toggleSubOption(itemId, subOption) {\r\n                if (!this.selectedSubOptions[itemId]) {\r\n                    this.$set(this.selectedSubOptions, itemId, []);\r\n                }\r\n\r\n                const index = this.selectedSubOptions[itemId].indexOf(subOption);\r\n                if (index > -1) {\r\n                    this.selectedSubOptions[itemId].splice(index, 1);\r\n                    // Remove photos for this sub-option\r\n                    if (this.detailedBeforePhotos[itemId]) {\r\n                        delete this.detailedBeforePhotos[itemId][subOption];\r\n                    }\r\n                    if (this.detailedAfterPhotos[itemId]) {\r\n                        delete this.detailedAfterPhotos[itemId][subOption];\r\n                    }\r\n                } else {\r\n                    this.selectedSubOptions[itemId].push(subOption);\r\n                    // Initialize photo storage\r\n                    if (!this.detailedBeforePhotos[itemId]) {\r\n                        this.$set(this.detailedBeforePhotos, itemId, {});\r\n                    }\r\n                    if (!this.detailedAfterPhotos[itemId]) {\r\n                        this.$set(this.detailedAfterPhotos, itemId, {});\r\n                    }\r\n                    this.$set(this.detailedBeforePhotos[itemId], subOption, []);\r\n                    this.$set(this.detailedAfterPhotos[itemId], subOption, []);\r\n                }\r\n            },\r\n\r\n            // Update side notes\r\n            updateSideNotes(itemId, event) {\r\n                this.$set(this.sideNotes, itemId, event.detail.value);\r\n            },\r\n\r\n            // Get selected sub-options for an item\r\n            getSelectedSubOptions(itemId) {\r\n                return this.selectedSubOptions[itemId] || [];\r\n            },\r\n\r\n            // Get sub-option label\r\n            getSubOptionLabel(area, subOptionValue) {\r\n                const subOptions = this.getSubOptionsForArea(area);\r\n                const found = subOptions.find(opt => opt.value === subOptionValue);\r\n                return found ? found.label : subOptionValue;\r\n            },\r\n\r\n            // Upload detailed photos\r\n            uploadDetailedPhotos(type, itemId, subOption) {\r\n                console.log(`Upload ${type} photos for ${itemId} - ${subOption}`);\r\n                uni.chooseImage({\r\n                    count: 9,\r\n                    success: (res) => {\r\n                        const photosObj = type === 'before' ? this.detailedBeforePhotos : this\r\n                            .detailedAfterPhotos;\r\n\r\n                        if (!photosObj[itemId]) {\r\n                            this.$set(photosObj, itemId, {});\r\n                        }\r\n                        if (!photosObj[itemId][subOption]) {\r\n                            this.$set(photosObj[itemId], subOption, []);\r\n                        }\r\n\r\n                        photosObj[itemId][subOption].push(...res.tempFilePaths);\r\n\r\n                        uni.showToast({\r\n                            title: `已选择 ${res.tempFilePaths.length} 张照片`,\r\n                            icon: 'success'\r\n                        });\r\n                    },\r\n                    fail: (err) => {\r\n                        console.error('选择图片失败:', err);\r\n                        uni.showToast({\r\n                            title: '选择图片失败',\r\n                            icon: 'error'\r\n                        });\r\n                    }\r\n                });\r\n            },\r\n\r\n            // Get detailed photo count\r\n            getDetailedPhotoCount(type, itemId, subOption) {\r\n                const photosObj = type === 'before' ? this.detailedBeforePhotos : this.detailedAfterPhotos;\r\n                return photosObj[itemId] && photosObj[itemId][subOption] ? photosObj[itemId][subOption].length : 0;\r\n            },\r\n\r\n            // Upload photos for custom options (其他部位)\r\n            uploadCustomOptionPhotos(type, option) {\r\n                console.log(`Upload ${type} photos for custom option ${option}`);\r\n                uni.chooseImage({\r\n                    count: 9,\r\n                    success: (res) => {\r\n                        if (!this.customOptionPhotos[type]) {\r\n                            this.$set(this.customOptionPhotos, type, {});\r\n                        }\r\n                        if (!this.customOptionPhotos[type][option]) {\r\n                            this.$set(this.customOptionPhotos[type], option, []);\r\n                        }\r\n\r\n                        this.customOptionPhotos[type][option].push(...res.tempFilePaths);\r\n\r\n                        uni.showToast({\r\n                            title: `已选择 ${res.tempFilePaths.length} 张照片`,\r\n                            icon: 'success'\r\n                        });\r\n                    },\r\n                    fail: (err) => {\r\n                        console.error('选择图片失败:', err);\r\n                        uni.showToast({\r\n                            title: '选择图片失败',\r\n                            icon: 'error'\r\n                        });\r\n                    }\r\n                });\r\n            },\r\n\r\n            // Get photo count for custom options\r\n            getCustomPhotoCount(type, option) {\r\n                return this.customOptionPhotos[type] && this.customOptionPhotos[type][option] ?\r\n                    this.customOptionPhotos[type][option].length : 0;\r\n            },\r\n\r\n            // Upload work photos\r\n            uploadWorkPhotos() {\r\n                console.log('Upload work photos');\r\n                uni.chooseImage({\r\n                    count: 9,\r\n                    success: (res) => {\r\n                        this.workPhotos.push(...res.tempFilePaths);\r\n\r\n                        uni.showToast({\r\n                            title: `已选择 ${res.tempFilePaths.length} 张照片`,\r\n                            icon: 'success'\r\n                        });\r\n                    },\r\n                    fail: (err) => {\r\n                        console.error('选择图片失败:', err);\r\n                        uni.showToast({\r\n                            title: '选择图片失败',\r\n                            icon: 'error'\r\n                        });\r\n                    }\r\n                });\r\n            },\r\n\r\n            // Check if after cleaning is complete\r\n            isAfterCleaningComplete() {\r\n                return this.selectedCleaningItems.every(item => {\r\n                    // For custom options, check if they have after photos\r\n                    if (item.value.startsWith('custom_')) {\r\n                        return this.getCustomPhotoCount('after', item.value) > 0;\r\n                    }\r\n                    // For regular options, check sub-options and their photos\r\n                    const selectedSubs = this.getSelectedSubOptions(item.id);\r\n                    return selectedSubs.every(subOption => {\r\n                        return this.getDetailedPhotoCount('after', item.id, subOption) > 0;\r\n                    });\r\n                });\r\n            },\r\n\r\n            // Check if step is completed\r\n            isStepCompleted(step) {\r\n                switch (step) {\r\n                    case 'beforeCleaning':\r\n                        return this.selectedCleaningItems.length > 0 &&\r\n                            this.selectedCleaningItems.every(item => {\r\n                                // For custom options, check if they have photos\r\n                                if (item.value.startsWith('custom_')) {\r\n                                    return this.getCustomPhotoCount('before', item.value) > 0;\r\n                                }\r\n                                // For regular options, check sub-options and their photos\r\n                                const selectedSubs = this.getSelectedSubOptions(item.id);\r\n                                return selectedSubs.length > 0 && selectedSubs.every(subOption => {\r\n                                    return this.getDetailedPhotoCount('before', item.id, subOption) > 0;\r\n                                });\r\n                            });\r\n                    case 'afterCleaning':\r\n                        return this.isAfterCleaningComplete();\r\n                    case 'workPhotos':\r\n                        return this.workPhotos.length > 0;\r\n                    case 'environmentNotes':\r\n                        return this.environmentNotes.trim().length > 0;\r\n                    default:\r\n                        return false;\r\n                }\r\n            },\r\n\r\n            async saveCleaningRecord() {\r\n                try {\r\n                    uni.showLoading({\r\n                        title: '保存中...'\r\n                    });\r\n\r\n                    const db = uniCloud.database();\r\n\r\n                    const record = {\r\n                        projectName: this.projectName || '未命名项目', // Add input for this\r\n                        projectLocation: this.projectLocation || '', // Add input for this\r\n                        cleaningDate: Date.now(),\r\n                        cleaningAreas: this.beforeCleaningSelected,\r\n                        selectedSubOptions: this.selectedSubOptions,\r\n                        customSubOptions: this.customSubOptions,\r\n                        sideNotes: this.sideNotes,\r\n                        detailedBeforePhotos: this.detailedBeforePhotos,\r\n                        detailedAfterPhotos: this.detailedAfterPhotos,\r\n                        workPhotos: this.workPhotos,\r\n                        environmentNotes: this.environmentNotes,\r\n                        workerName: this.userInfo.name,\r\n                        workerCompany: this.userInfo.company,\r\n                        userId: uni.getStorageSync('userId') || 'temp_user',\r\n                        status: 'draft',\r\n                        // Optional: link to inspection record\r\n                        relatedInspectionId: this.relatedInspectionId || null\r\n                    };\r\n\r\n                    const result = await db.collection('construction_records').add(record);\r\n\r\n                    uni.hideLoading();\r\n                    uni.showToast({\r\n                        title: '保存成功',\r\n                        icon: 'success'\r\n                    });\r\n\r\n                    // Navigate back or to list\r\n                    setTimeout(() => {\r\n                        uni.navigateBack();\r\n                    }, 1500);\r\n\r\n                } catch (error) {\r\n                    uni.hideLoading();\r\n                    console.error('保存失败:', error);\r\n                    uni.showToast({\r\n                        title: '保存失败: ' + error.message,\r\n                        icon: 'none'\r\n                    });\r\n                }\r\n            },\r\n\r\n            // Load saved data\r\n            loadSavedData() {\r\n                try {\r\n                    const savedData = uni.getStorageSync('cleaningData');\r\n                    if (savedData) {\r\n                        this.selectedCleaningItems = savedData.selectedCleaningItems || [];\r\n                        this.selectedSubOptions = savedData.selectedSubOptions || {};\r\n                        this.sideNotes = savedData.sideNotes || {};\r\n                        this.detailedBeforePhotos = savedData.detailedBeforePhotos || {};\r\n                        this.detailedAfterPhotos = savedData.detailedAfterPhotos || {};\r\n                        this.workPhotos = savedData.workPhotos || [];\r\n                        this.environmentNotes = savedData.environmentNotes || '';\r\n\r\n                        // Restore custom options\r\n                        if (savedData.customOptions) {\r\n                            this.cleaningOptions.push(...savedData.customOptions);\r\n                        }\r\n                    }\r\n                } catch (error) {\r\n                    console.error('加载保存数据失败:', error);\r\n                }\r\n            }\r\n        }\r\n    };\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n    .page-container {\r\n        position: relative;\r\n        min-height: 100vh;\r\n    }\r\n\r\n    .sidebar {\r\n        position: fixed;\r\n        left: 0;\r\n        top: 0;\r\n        width: 300rpx;\r\n        height: 100vh;\r\n        background: #f5f5f5;\r\n        box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1);\r\n        z-index: 1000;\r\n        transition: width 0.3s ease;\r\n\r\n        &.sidebar-hidden {\r\n            width: 80rpx;\r\n        }\r\n    }\r\n\r\n    .sidebar-content {\r\n        padding: 40rpx 20rpx;\r\n        padding-top: 100rpx;\r\n        opacity: 1;\r\n        transition: opacity 0.3s ease;\r\n\r\n        .sidebar-hidden & {\r\n            opacity: 0;\r\n            pointer-events: none;\r\n        }\r\n    }\r\n\r\n    .step-nav {\r\n        padding: 30rpx 20rpx;\r\n        margin-bottom: 20rpx;\r\n        border-radius: 12rpx;\r\n        background-color: #e0e0e0;\r\n        color: #666;\r\n        cursor: pointer;\r\n        transition: all 0.3s ease;\r\n        text-align: center;\r\n        font-size: 28rpx;\r\n        position: relative;\r\n\r\n        &:hover {\r\n            background-color: #d0d0d0;\r\n            transform: translateX(10rpx);\r\n        }\r\n\r\n        &.active {\r\n            background-color: #007AFF;\r\n            color: white;\r\n\r\n            &:not(.completed) {\r\n                &::after {\r\n                    display: none;\r\n                }\r\n            }\r\n        }\r\n\r\n        &.completed {\r\n            background-color: #4CAF50;\r\n            color: white;\r\n            position: relative;\r\n\r\n            // Remove checkmark for step 2 (afterCleaning)\r\n            &:not([data-step=\"afterCleaning\"])::after {\r\n                content: '✓';\r\n                position: absolute;\r\n                top: -8rpx;\r\n                right: -8rpx;\r\n                background-color: #2E7D32;\r\n                color: white;\r\n                border-radius: 50%;\r\n                width: 30rpx;\r\n                height: 30rpx;\r\n                font-size: 18rpx;\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n            }\r\n        }\r\n\r\n        &.locked {\r\n            background-color: #f5f5f5;\r\n            color: #ccc;\r\n            cursor: not-allowed;\r\n\r\n            &:hover {\r\n                background-color: #f5f5f5;\r\n                transform: none;\r\n            }\r\n        }\r\n    }\r\n\r\n    .lock-icon {\r\n        font-size: 20rpx;\r\n        margin-left: 10rpx;\r\n    }\r\n\r\n    .mini-sidebar {\r\n        position: fixed;\r\n        left: 0;\r\n        top: 0;\r\n        width: 80rpx;\r\n        height: 100vh;\r\n        background: #f5f5f5;\r\n        z-index: 1001;\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        opacity: 0;\r\n        transition: opacity 0.3s ease;\r\n        pointer-events: none;\r\n\r\n        .sidebar-hidden~& {\r\n            opacity: 1;\r\n            pointer-events: all;\r\n        }\r\n    }\r\n\r\n    .mini-step {\r\n        width: 50rpx;\r\n        height: 50rpx;\r\n        border-radius: 50%;\r\n        background-color: #e0e0e0;\r\n        color: #666;\r\n        margin-bottom: 20rpx;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 22rpx;\r\n        cursor: pointer;\r\n        transition: all 0.3s ease;\r\n        position: relative;\r\n\r\n        &:hover {\r\n            background-color: #d0d0d0;\r\n            transform: scale(1.1);\r\n        }\r\n\r\n        &.active {\r\n            background-color: #007AFF;\r\n            color: white;\r\n        }\r\n\r\n        &.completed {\r\n            background-color: #4CAF50;\r\n            color: white;\r\n        }\r\n\r\n        &.locked {\r\n            background-color: #f5f5f5;\r\n            color: #ccc;\r\n            cursor: not-allowed;\r\n\r\n            &:hover {\r\n                background-color: #f5f5f5;\r\n                transform: none;\r\n            }\r\n        }\r\n    }\r\n\r\n    .mini-lock {\r\n        position: absolute;\r\n        top: -5rpx;\r\n        right: -5rpx;\r\n        font-size: 16rpx;\r\n    }\r\n\r\n    .sidebar-toggle {\r\n        position: fixed;\r\n        left: 20rpx;\r\n        top: 20rpx;\r\n        width: 50rpx;\r\n        height: 50rpx;\r\n        background-color: #666;\r\n        color: white;\r\n        border-radius: 50%;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        cursor: pointer;\r\n        z-index: 1002;\r\n        box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.2);\r\n\r\n        &:hover {\r\n            background-color: #555;\r\n        }\r\n    }\r\n\r\n    .main-content {\r\n        margin-left: 300rpx;\r\n        transition: margin-left 0.3s ease;\r\n        min-height: 100vh;\r\n        padding: 20rpx;\r\n\r\n        &.content-expanded {\r\n            margin-left: 80rpx;\r\n        }\r\n    }\r\n\r\n    .container {\r\n        max-width: 800rpx;\r\n        margin: 0 auto;\r\n    }\r\n\r\n    .form-section {\r\n        background: white;\r\n        border-radius: 16rpx;\r\n        padding: 40rpx;\r\n        margin-bottom: 20rpx;\r\n        box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\r\n    }\r\n\r\n    .section-title {\r\n        font-size: 44rpx;\r\n        font-weight: bold;\r\n        color: #333;\r\n        margin-bottom: 30rpx;\r\n        text-align: center;\r\n    }\r\n\r\n    .section-subtitle {\r\n        font-size: 36rpx;\r\n        font-weight: bold;\r\n        color: #333;\r\n        margin-bottom: 30rpx;\r\n        text-align: center;\r\n        border-bottom: 2rpx solid #e5e5e5;\r\n        padding-bottom: 20rpx;\r\n    }\r\n\r\n    .login-status {\r\n        background-color: #f0f8ff;\r\n        padding: 20rpx;\r\n        border-radius: 12rpx;\r\n        margin-bottom: 30rpx;\r\n        text-align: center;\r\n    }\r\n\r\n    .status-text {\r\n        color: #007AFF;\r\n        font-size: 28rpx;\r\n    }\r\n\r\n    .cleaning-options {\r\n        margin-bottom: 30rpx;\r\n        padding: 30rpx;\r\n        background-color: #fff8e1;\r\n        border-radius: 16rpx;\r\n        border: 2rpx solid #ffc107;\r\n    }\r\n\r\n    .options-title {\r\n        font-size: 32rpx;\r\n        font-weight: bold;\r\n        color: #333;\r\n        margin-bottom: 20rpx;\r\n        text-align: center;\r\n    }\r\n\r\n    .option-grid {\r\n        display: grid;\r\n        grid-template-columns: repeat(2, 1fr);\r\n        gap: 20rpx;\r\n    }\r\n\r\n    .option-item {\r\n        position: relative;\r\n        padding: 30rpx;\r\n        border: 2rpx solid #e5e5e5;\r\n        border-radius: 12rpx;\r\n        text-align: center;\r\n        cursor: pointer;\r\n        transition: all 0.3s ease;\r\n\r\n        &:hover {\r\n            border-color: #007AFF;\r\n            background-color: #f0f8ff;\r\n        }\r\n\r\n        &:active {\r\n            transform: scale(0.98);\r\n        }\r\n    }\r\n\r\n    .option-text {\r\n        font-size: 28rpx;\r\n        color: #333;\r\n    }\r\n\r\n    .sub-options-section {\r\n        margin: 20rpx 0;\r\n        padding: 20rpx;\r\n        background-color: #f9f9f9;\r\n        border-radius: 12rpx;\r\n    }\r\n\r\n    .sub-options-title {\r\n        font-size: 28rpx;\r\n        font-weight: bold;\r\n        color: #333;\r\n        margin-bottom: 15rpx;\r\n    }\r\n\r\n    .sub-option-grid {\r\n        display: grid;\r\n        grid-template-columns: repeat(3, 1fr);\r\n        gap: 15rpx;\r\n    }\r\n\r\n    .sub-option-item {\r\n        position: relative;\r\n        padding: 20rpx;\r\n        border: 2rpx solid #e5e5e5;\r\n        border-radius: 8rpx;\r\n        text-align: center;\r\n        cursor: pointer;\r\n        transition: all 0.3s ease;\r\n        background-color: white;\r\n\r\n        &.selected {\r\n            border-color: #007AFF;\r\n            background-color: #f0f8ff;\r\n        }\r\n    }\r\n\r\n    .sub-option-text {\r\n        font-size: 24rpx;\r\n        color: #333;\r\n    }\r\n\r\n    .sub-option-checkbox {\r\n        position: absolute;\r\n        top: -6rpx;\r\n        right: -6rpx;\r\n        background-color: #007AFF;\r\n        color: white;\r\n        border-radius: 50%;\r\n        width: 24rpx;\r\n        height: 24rpx;\r\n        font-size: 16rpx;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n    }\r\n\r\n    .sub-photos-section {\r\n        margin-top: 20rpx;\r\n    }\r\n\r\n    .sub-photo-item {\r\n        margin-bottom: 20rpx;\r\n    }\r\n\r\n    .sub-photo-label {\r\n        display: block;\r\n        font-size: 26rpx;\r\n        font-weight: bold;\r\n        color: #555;\r\n        margin-bottom: 8rpx;\r\n    }\r\n\r\n    .form-group {\r\n        margin-bottom: 30rpx;\r\n    }\r\n\r\n    .label {\r\n        display: block;\r\n        font-size: 28rpx;\r\n        color: #333;\r\n        margin-bottom: 10rpx;\r\n        font-weight: 500;\r\n    }\r\n\r\n    .input,\r\n    .textarea {\r\n        width: 100%;\r\n        min-height: 80rpx;\r\n        padding: 0 25rpx;\r\n        border: 2rpx solid #e5e5e5;\r\n        border-radius: 12rpx;\r\n        font-size: 32rpx;\r\n        line-height: 1.2;\r\n        vertical-align: middle;\r\n        background-color: #fafafa;\r\n        box-sizing: border-box;\r\n\r\n        &:focus {\r\n            border-color: #007AFF;\r\n            background-color: white;\r\n        }\r\n    }\r\n\r\n    .textarea {\r\n        min-height: 120rpx;\r\n        resize: none;\r\n    }\r\n\r\n    .tall-input {\r\n        min-height: 80rpx;\r\n        height: 80rpx;\r\n    }\r\n\r\n    .small-textarea {\r\n        min-height: 60rpx;\r\n        height: 60rpx;\r\n    }\r\n\r\n    .notes-display {\r\n        padding: 20rpx;\r\n        background-color: #f9f9f9;\r\n        border-radius: 8rpx;\r\n        border: 1rpx solid #e5e5e5;\r\n        color: #666;\r\n        font-size: 26rpx;\r\n        line-height: 1.4;\r\n    }\r\n\r\n    .add-custom-btn {\r\n        margin-top: 20rpx;\r\n        padding: 20rpx;\r\n        background-color: #007AFF;\r\n        color: white;\r\n        border-radius: 8rpx;\r\n        border: none;\r\n        font-size: 24rpx;\r\n        cursor: pointer;\r\n\r\n        &:active {\r\n            background-color: #0066CC;\r\n        }\r\n    }\r\n\r\n    .selected-options {\r\n        margin-top: 30rpx;\r\n    }\r\n\r\n    .selected-option {\r\n        margin-bottom: 30rpx;\r\n        padding: 20rpx;\r\n        border: 1rpx solid #e5e5e5;\r\n        border-radius: 12rpx;\r\n        background-color: #fafafa;\r\n    }\r\n\r\n    .option-header {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        margin-bottom: 20rpx;\r\n    }\r\n\r\n    .option-label {\r\n        display: block;\r\n        font-size: 32rpx;\r\n        font-weight: bold;\r\n        color: white;\r\n        padding: 15rpx;\r\n        border-radius: 8rpx;\r\n        background-color: #007AFF;\r\n        flex: 1;\r\n        text-align: center;\r\n    }\r\n\r\n    .remove-btn {\r\n        padding: 10rpx 20rpx;\r\n        background-color: #ff4444;\r\n        color: white;\r\n        border: none;\r\n        border-radius: 6rpx;\r\n        font-size: 22rpx;\r\n        margin-left: 15rpx;\r\n        cursor: pointer;\r\n\r\n        &:active {\r\n            background-color: #cc0000;\r\n        }\r\n    }\r\n\r\n    .photo-upload-area {\r\n        border: 2rpx dashed #ccc;\r\n        border-radius: 12rpx;\r\n        padding: 40rpx;\r\n        text-align: center;\r\n        cursor: pointer;\r\n        transition: all 0.3s ease;\r\n\r\n        &:hover {\r\n            border-color: #007AFF;\r\n        }\r\n\r\n        &:active {\r\n            transform: scale(0.98);\r\n        }\r\n    }\r\n\r\n    .photo-upload-section {\r\n        margin-bottom: 30rpx;\r\n    }\r\n\r\n    .photo-count {\r\n        display: block;\r\n        font-size: 24rpx;\r\n        color: #666;\r\n        margin-top: 10rpx;\r\n    }\r\n\r\n    .button-group {\r\n        display: flex;\r\n        gap: 20rpx;\r\n        margin-top: 40rpx;\r\n    }\r\n\r\n    .btn-save,\r\n    .btn-secondary {\r\n        flex: 1;\r\n        padding: 24rpx 0;\r\n        border-radius: 12rpx;\r\n        font-size: 32rpx;\r\n        border: none;\r\n        cursor: pointer;\r\n        transition: all 0.3s ease;\r\n    }\r\n\r\n    .btn-save {\r\n        background-color: #007AFF;\r\n        color: white;\r\n\r\n        &:active {\r\n            background-color: #0066CC;\r\n        }\r\n\r\n        &.btn-disabled {\r\n            background-color: #ccc !important;\r\n            cursor: not-allowed;\r\n\r\n            &:active {\r\n                background-color: #ccc !important;\r\n            }\r\n        }\r\n    }\r\n\r\n    .btn-secondary {\r\n        background-color: #f0f0f0;\r\n        color: #666;\r\n\r\n        &:active {\r\n            background-color: #e0e0e0;\r\n        }\r\n    }\r\n</style>","import MiniProgramPage from 'C:/Users/31110/Documents/HBuilderProjects/test/pages/construction/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":";;AAkQI,MAAK,YAAU;AAAA,EACX,OAAO;AACH,WAAO;AAAA,MACH,aAAa;AAAA,MACb,gBAAgB;AAAA;AAAA,MAGhB,iBAAiB;AAAA,QAAC;AAAA,UACV,OAAO;AAAA,UACP,OAAO;AAAA,QACV;AAAA,QACD;AAAA,UACI,OAAO;AAAA,UACP,OAAO;AAAA,QACV;AAAA,QACD;AAAA,UACI,OAAO;AAAA,UACP,OAAO;AAAA,QACV;AAAA,QACD;AAAA,UACI,OAAO;AAAA,UACP,OAAO;AAAA,QACX;AAAA,MACH;AAAA;AAAA,MAGD,oBAAoB;AAAA,QAChB,SAAS;AAAA,UAAC;AAAA,YACF,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACX;AAAA,QACH;AAAA,QACD,MAAM;AAAA,UAAC;AAAA,YACC,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACX;AAAA,QACH;AAAA,QACD,KAAK;AAAA,UAAC;AAAA,YACE,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACX;AAAA,QACH;AAAA,QACD,UAAU;AAAA,UAAC;AAAA,YACH,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACV;AAAA,UACD;AAAA,YACI,OAAO;AAAA,YACP,OAAO;AAAA,UACX;AAAA,QACJ;AAAA,MACH;AAAA;AAAA,MAGD,oBAAoB;AAAA,QAChB,QAAQ,CAAE;AAAA;AAAA,QACV,OAAO,CAAC;AAAA,MACX;AAAA;AAAA,MAGD,uBAAuB,CAAE;AAAA;AAAA,MACzB,oBAAoB;AAAA;AAAA,MAGpB,oBAAoB,CAAE;AAAA;AAAA;AAAA,MAGtB,WAAW,CAAE;AAAA;AAAA;AAAA,MAGb,sBAAsB,CAAE;AAAA;AAAA,MACxB,qBAAqB,CAAE;AAAA,MAEvB,YAAY,CAAE;AAAA,MACd,kBAAkB;AAAA,MAElB,UAAU;AAAA,QACN,MAAMA,cAAG,MAAC,eAAe,UAAU,KAAK;AAAA,QACxC,SAASA,cAAG,MAAC,eAAe,aAAa,KAAK;AAAA,MAClD;AAAA;EAEP;AAAA,EAED,SAAS;AAELA,wBAAI,kBAAkB,cAAc;AAGpC,SAAK,cAAa;AAAA,EACrB;AAAA,EAED,SAAS;AAAA;AAAA,IAEL,SAAS,MAAM;AAEX,UAAI,SAAS,iBAAiB;AAE1B,YAAI,CAAC,KAAK,gBAAgB,gBAAgB,GAAG;AACzCA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,YACN,UAAU;AAAA,UACd,CAAC;AACD;AAAA,QACJ;AAAA,MACJ;AAGA,WAAK,cAAc;AAAA,IACtB;AAAA;AAAA,IAGD,kBAAkB,OAAO;AACrB,YAAM,WAAW,KAAK,IAAG,IAAK,MAAM,KAAK;AACzC,YAAM,SAAS,KAAK,gBAAgB,KAAK,SAAO,IAAI,UAAU,KAAK;AAEnE,YAAM,UAAU;AAAA,QACZ,IAAI;AAAA,QACJ;AAAA,QACA,OAAO,OAAO;AAAA;AAGlB,WAAK,sBAAsB,KAAK,OAAO;AAGvC,WAAK,KAAK,KAAK,oBAAoB,UAAU,CAAE,CAAA;AAC/C,WAAK,KAAK,KAAK,sBAAsB,UAAU,CAAE,CAAA;AACjD,WAAK,KAAK,KAAK,qBAAqB,UAAU,CAAE,CAAA;AAChD,WAAK,KAAK,KAAK,WAAW,UAAU,EAAE;AAAA,IACzC;AAAA;AAAA,IAGD,mBAAmB,QAAQ;AACvB,YAAM,QAAQ,KAAK,sBAAsB,UAAU,UAAQ,KAAK,OAAO,MAAM;AAC7E,UAAI,QAAQ,IAAI;AACZ,aAAK,sBAAsB,OAAO,OAAO,CAAC;AAC1C,eAAO,KAAK,mBAAmB,MAAM;AACrC,eAAO,KAAK,qBAAqB,MAAM;AACvC,eAAO,KAAK,oBAAoB,MAAM;AACtC,eAAO,KAAK,UAAU,MAAM;AAAA,MAChC;AAAA,IACH;AAAA;AAAA,IAGD,wBAAwB;AACpB,UAAI,KAAK,mBAAmB,QAAQ;AAChC,cAAM,cAAc,YAAY,KAAK,IAAG;AACxC,aAAK,gBAAgB,KAAK;AAAA,UACtB,OAAO;AAAA,UACP,OAAO,KAAK,mBAAmB,KAAK;AAAA,QACxC,CAAC;AAGD,aAAK,kBAAkB,WAAW;AAClC,aAAK,qBAAqB;AAC1B,aAAK,KAAK,KAAK,mBAAmB,QAAQ,aAAa,CAAA,CAAE;AACzD,aAAK,KAAK,KAAK,mBAAmB,OAAO,aAAa,CAAA,CAAE;AAAA,MAC5D;AAAA,IACH;AAAA;AAAA,IAGD,qBAAqB,MAAM;AACvB,aAAO,KAAK,mBAAmB,IAAI,KAAK,CAAA;AAAA,IAC3C;AAAA;AAAA,IAGD,oBAAoB,QAAQ,WAAW;AACnC,aAAO,KAAK,mBAAmB,MAAM,KAAK,KAAK,mBAAmB,MAAM,EAAE,SAAS,SAAS;AAAA,IAC/F;AAAA;AAAA,IAGD,gBAAgB,QAAQ,WAAW;AAC/B,UAAI,CAAC,KAAK,mBAAmB,MAAM,GAAG;AAClC,aAAK,KAAK,KAAK,oBAAoB,QAAQ,CAAE,CAAA;AAAA,MACjD;AAEA,YAAM,QAAQ,KAAK,mBAAmB,MAAM,EAAE,QAAQ,SAAS;AAC/D,UAAI,QAAQ,IAAI;AACZ,aAAK,mBAAmB,MAAM,EAAE,OAAO,OAAO,CAAC;AAE/C,YAAI,KAAK,qBAAqB,MAAM,GAAG;AACnC,iBAAO,KAAK,qBAAqB,MAAM,EAAE,SAAS;AAAA,QACtD;AACA,YAAI,KAAK,oBAAoB,MAAM,GAAG;AAClC,iBAAO,KAAK,oBAAoB,MAAM,EAAE,SAAS;AAAA,QACrD;AAAA,aACG;AACH,aAAK,mBAAmB,MAAM,EAAE,KAAK,SAAS;AAE9C,YAAI,CAAC,KAAK,qBAAqB,MAAM,GAAG;AACpC,eAAK,KAAK,KAAK,sBAAsB,QAAQ,CAAE,CAAA;AAAA,QACnD;AACA,YAAI,CAAC,KAAK,oBAAoB,MAAM,GAAG;AACnC,eAAK,KAAK,KAAK,qBAAqB,QAAQ,CAAE,CAAA;AAAA,QAClD;AACA,aAAK,KAAK,KAAK,qBAAqB,MAAM,GAAG,WAAW,CAAA,CAAE;AAC1D,aAAK,KAAK,KAAK,oBAAoB,MAAM,GAAG,WAAW,CAAA,CAAE;AAAA,MAC7D;AAAA,IACH;AAAA;AAAA,IAGD,gBAAgB,QAAQ,OAAO;AAC3B,WAAK,KAAK,KAAK,WAAW,QAAQ,MAAM,OAAO,KAAK;AAAA,IACvD;AAAA;AAAA,IAGD,sBAAsB,QAAQ;AAC1B,aAAO,KAAK,mBAAmB,MAAM,KAAK,CAAA;AAAA,IAC7C;AAAA;AAAA,IAGD,kBAAkB,MAAM,gBAAgB;AACpC,YAAM,aAAa,KAAK,qBAAqB,IAAI;AACjD,YAAM,QAAQ,WAAW,KAAK,SAAO,IAAI,UAAU,cAAc;AACjE,aAAO,QAAQ,MAAM,QAAQ;AAAA,IAChC;AAAA;AAAA,IAGD,qBAAqB,MAAM,QAAQ,WAAW;AAC1CA,oBAAAA,MAAA,MAAA,OAAA,uCAAY,UAAU,IAAI,eAAe,MAAM,MAAM,SAAS,EAAE;AAChEA,oBAAAA,MAAI,YAAY;AAAA,QACZ,OAAO;AAAA,QACP,SAAS,CAAC,QAAQ;AACd,gBAAM,YAAY,SAAS,WAAW,KAAK,uBAAuB,KAC7D;AAEL,cAAI,CAAC,UAAU,MAAM,GAAG;AACpB,iBAAK,KAAK,WAAW,QAAQ,CAAE,CAAA;AAAA,UACnC;AACA,cAAI,CAAC,UAAU,MAAM,EAAE,SAAS,GAAG;AAC/B,iBAAK,KAAK,UAAU,MAAM,GAAG,WAAW,CAAA,CAAE;AAAA,UAC9C;AAEA,oBAAU,MAAM,EAAE,SAAS,EAAE,KAAK,GAAG,IAAI,aAAa;AAEtDA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,OAAO,IAAI,cAAc,MAAM;AAAA,YACtC,MAAM;AAAA,UACV,CAAC;AAAA,QACJ;AAAA,QACD,MAAM,CAAC,QAAQ;AACXA,wBAAc,MAAA,MAAA,SAAA,uCAAA,WAAW,GAAG;AAC5BA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACV,CAAC;AAAA,QACL;AAAA,MACJ,CAAC;AAAA,IACJ;AAAA;AAAA,IAGD,sBAAsB,MAAM,QAAQ,WAAW;AAC3C,YAAM,YAAY,SAAS,WAAW,KAAK,uBAAuB,KAAK;AACvE,aAAO,UAAU,MAAM,KAAK,UAAU,MAAM,EAAE,SAAS,IAAI,UAAU,MAAM,EAAE,SAAS,EAAE,SAAS;AAAA,IACpG;AAAA;AAAA,IAGD,yBAAyB,MAAM,QAAQ;AACnCA,0BAAA,MAAA,OAAA,uCAAY,UAAU,IAAI,6BAA6B,MAAM,EAAE;AAC/DA,oBAAAA,MAAI,YAAY;AAAA,QACZ,OAAO;AAAA,QACP,SAAS,CAAC,QAAQ;AACd,cAAI,CAAC,KAAK,mBAAmB,IAAI,GAAG;AAChC,iBAAK,KAAK,KAAK,oBAAoB,MAAM,CAAE,CAAA;AAAA,UAC/C;AACA,cAAI,CAAC,KAAK,mBAAmB,IAAI,EAAE,MAAM,GAAG;AACxC,iBAAK,KAAK,KAAK,mBAAmB,IAAI,GAAG,QAAQ,CAAA,CAAE;AAAA,UACvD;AAEA,eAAK,mBAAmB,IAAI,EAAE,MAAM,EAAE,KAAK,GAAG,IAAI,aAAa;AAE/DA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,OAAO,IAAI,cAAc,MAAM;AAAA,YACtC,MAAM;AAAA,UACV,CAAC;AAAA,QACJ;AAAA,QACD,MAAM,CAAC,QAAQ;AACXA,wBAAc,MAAA,MAAA,SAAA,uCAAA,WAAW,GAAG;AAC5BA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACV,CAAC;AAAA,QACL;AAAA,MACJ,CAAC;AAAA,IACJ;AAAA;AAAA,IAGD,oBAAoB,MAAM,QAAQ;AAC9B,aAAO,KAAK,mBAAmB,IAAI,KAAK,KAAK,mBAAmB,IAAI,EAAE,MAAM,IACxE,KAAK,mBAAmB,IAAI,EAAE,MAAM,EAAE,SAAS;AAAA,IACtD;AAAA;AAAA,IAGD,mBAAmB;AACfA,oBAAAA,MAAA,MAAA,OAAA,uCAAY,oBAAoB;AAChCA,oBAAAA,MAAI,YAAY;AAAA,QACZ,OAAO;AAAA,QACP,SAAS,CAAC,QAAQ;AACd,eAAK,WAAW,KAAK,GAAG,IAAI,aAAa;AAEzCA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,OAAO,IAAI,cAAc,MAAM;AAAA,YACtC,MAAM;AAAA,UACV,CAAC;AAAA,QACJ;AAAA,QACD,MAAM,CAAC,QAAQ;AACXA,wBAAc,MAAA,MAAA,SAAA,uCAAA,WAAW,GAAG;AAC5BA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACV,CAAC;AAAA,QACL;AAAA,MACJ,CAAC;AAAA,IACJ;AAAA;AAAA,IAGD,0BAA0B;AACtB,aAAO,KAAK,sBAAsB,MAAM,UAAQ;AAE5C,YAAI,KAAK,MAAM,WAAW,SAAS,GAAG;AAClC,iBAAO,KAAK,oBAAoB,SAAS,KAAK,KAAK,IAAI;AAAA,QAC3D;AAEA,cAAM,eAAe,KAAK,sBAAsB,KAAK,EAAE;AACvD,eAAO,aAAa,MAAM,eAAa;AACnC,iBAAO,KAAK,sBAAsB,SAAS,KAAK,IAAI,SAAS,IAAI;AAAA,QACrE,CAAC;AAAA,MACL,CAAC;AAAA,IACJ;AAAA;AAAA,IAGD,gBAAgB,MAAM;AAClB,cAAQ,MAAI;AAAA,QACR,KAAK;AACD,iBAAO,KAAK,sBAAsB,SAAS,KACvC,KAAK,sBAAsB,MAAM,UAAQ;AAErC,gBAAI,KAAK,MAAM,WAAW,SAAS,GAAG;AAClC,qBAAO,KAAK,oBAAoB,UAAU,KAAK,KAAK,IAAI;AAAA,YAC5D;AAEA,kBAAM,eAAe,KAAK,sBAAsB,KAAK,EAAE;AACvD,mBAAO,aAAa,SAAS,KAAK,aAAa,MAAM,eAAa;AAC9D,qBAAO,KAAK,sBAAsB,UAAU,KAAK,IAAI,SAAS,IAAI;AAAA,YACtE,CAAC;AAAA,UACL,CAAC;AAAA,QACT,KAAK;AACD,iBAAO,KAAK;QAChB,KAAK;AACD,iBAAO,KAAK,WAAW,SAAS;AAAA,QACpC,KAAK;AACD,iBAAO,KAAK,iBAAiB,KAAI,EAAG,SAAS;AAAA,QACjD;AACI,iBAAO;AAAA,MACf;AAAA,IACH;AAAA,IAED,MAAM,qBAAqB;AACvB,UAAI;AACAA,sBAAAA,MAAI,YAAY;AAAA,UACZ,OAAO;AAAA,QACX,CAAC;AAED,cAAM,KAAKC,iBAAS;AAEpB,cAAM,SAAS;AAAA,UACX,aAAa,KAAK,eAAe;AAAA;AAAA,UACjC,iBAAiB,KAAK,mBAAmB;AAAA;AAAA,UACzC,cAAc,KAAK,IAAK;AAAA,UACxB,eAAe,KAAK;AAAA,UACpB,oBAAoB,KAAK;AAAA,UACzB,kBAAkB,KAAK;AAAA,UACvB,WAAW,KAAK;AAAA,UAChB,sBAAsB,KAAK;AAAA,UAC3B,qBAAqB,KAAK;AAAA,UAC1B,YAAY,KAAK;AAAA,UACjB,kBAAkB,KAAK;AAAA,UACvB,YAAY,KAAK,SAAS;AAAA,UAC1B,eAAe,KAAK,SAAS;AAAA,UAC7B,QAAQD,cAAG,MAAC,eAAe,QAAQ,KAAK;AAAA,UACxC,QAAQ;AAAA;AAAA,UAER,qBAAqB,KAAK,uBAAuB;AAAA;AAGrD,cAAM,SAAS,MAAM,GAAG,WAAW,sBAAsB,EAAE,IAAI,MAAM;AAErEA,sBAAG,MAAC,YAAW;AACfA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAC;AAGD,mBAAW,MAAM;AACbA,wBAAG,MAAC,aAAY;AAAA,QACnB,GAAE,IAAI;AAAA,MAET,SAAO,OAAO;AACZA,sBAAG,MAAC,YAAW;AACfA,sBAAA,MAAA,MAAA,SAAA,uCAAc,SAAS,KAAK;AAC5BA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO,WAAW,MAAM;AAAA,UACxB,MAAM;AAAA,QACV,CAAC;AAAA,MACL;AAAA,IACH;AAAA;AAAA,IAGD,gBAAgB;AACZ,UAAI;AACA,cAAM,YAAYA,cAAAA,MAAI,eAAe,cAAc;AACnD,YAAI,WAAW;AACX,eAAK,wBAAwB,UAAU,yBAAyB,CAAA;AAChE,eAAK,qBAAqB,UAAU,sBAAsB,CAAA;AAC1D,eAAK,YAAY,UAAU,aAAa,CAAA;AACxC,eAAK,uBAAuB,UAAU,wBAAwB,CAAA;AAC9D,eAAK,sBAAsB,UAAU,uBAAuB,CAAA;AAC5D,eAAK,aAAa,UAAU,cAAc,CAAA;AAC1C,eAAK,mBAAmB,UAAU,oBAAoB;AAGtD,cAAI,UAAU,eAAe;AACzB,iBAAK,gBAAgB,KAAK,GAAG,UAAU,aAAa;AAAA,UACxD;AAAA,QACJ;AAAA,MACF,SAAO,OAAO;AACZA,sBAAA,MAAA,MAAA,SAAA,uCAAc,aAAa,KAAK;AAAA,MACpC;AAAA,IACJ;AAAA,EACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvtBR,GAAG,WAAW,eAAe;"}