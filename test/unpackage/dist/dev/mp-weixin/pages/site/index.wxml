<view class="page-container"><view class="{{['sidebar', m && 'sidebar-hidden']}}"><view class="sidebar-content"><view class="{{['step-nav', a && 'active', b && 'completed']}}" bindtap="{{c}}">1. 准备</view><view class="{{['step-nav', d && 'active', e && 'completed']}}" bindtap="{{f}}">2. 环境信息</view><view class="{{['step-nav', g && 'active', h && 'completed']}}" bindtap="{{i}}">3. 踏勘</view><view class="{{['step-nav', j && 'active', k && 'completed']}}" bindtap="{{l}}">4. 完成</view></view></view><view wx:if="{{n}}" class="mini-sidebar"><view bindtap="{{o}}" class="{{['mini-step', p && 'active', q && 'completed']}}">1</view><view bindtap="{{r}}" class="{{['mini-step', s && 'active', t && 'completed']}}">2</view><view bindtap="{{v}}" class="{{['mini-step', w && 'active', x && 'completed']}}">3</view><view bindtap="{{y}}" class="{{['mini-step', z && 'active', A && 'completed']}}">4</view></view><view class="sidebar-toggle" bindtap="{{C}}"><text>{{B}}</text></view><view class="{{['main-content', aC && 'content-expanded']}}"><view class="container"><view class="form-section"><view class="section-title">现场踏勘表单</view><view class="login-status"><text class="status-text">已登录: {{D}} ({{E}})</text></view><view wx:if="{{F}}"><view class="form-group"><text class="label">归属</text><input class="input" placeholder="请输入归属公司" value="{{G}}" bindinput="{{H}}"/></view><view class="form-group"><text class="label">踏勘人员</text><input class="input" placeholder="请输入踏勘人员姓名" value="{{I}}" bindinput="{{J}}"/></view><view class="form-group"><text class="label">现场位置</text><view class="location-display-box"><text class="location-text">{{K}}</text></view><button class="location-btn" bindtap="{{L}}">选择位置</button></view><view class="form-group"><text class="label">名称</text><input class="input" placeholder="请输入名称" value="{{M}}" bindinput="{{N}}"/></view><view class="button-group"><button class="btn-save" bindtap="{{O}}">下一步：环境信息</button></view></view><view wx:if="{{P}}"><view class="section-subtitle">环境信息</view><view class="form-group"><text class="label">停车场入口及价格</text><input class="input" placeholder="请输入停车场入口及价格信息" value="{{Q}}" bindinput="{{R}}"/></view><view class="form-group"><text class="label">建议停车位</text><input class="input" placeholder="请输入建议停车位信息" value="{{S}}" bindinput="{{T}}"/></view><view class="form-group"><text class="label">电梯入口</text><input class="input" placeholder="请输入电梯入口信息" value="{{U}}" bindinput="{{V}}"/></view><view class="form-group"><text class="label">建议路线</text><input class="input" placeholder="请输入建议路线信息" value="{{W}}" bindinput="{{X}}"/></view><view class="form-group"><text class="label">楼顶施工环境</text><input class="input" placeholder="请输入楼顶施工环境信息" value="{{Y}}" bindinput="{{Z}}"/></view><view class="form-group"><text class="label">取水电情况</text><input class="input" placeholder="请输入取水电情况信息" value="{{aa}}" bindinput="{{ab}}"/></view><view class="form-group"><text class="label">其他情况</text><input class="input" placeholder="请输入其他情况信息" value="{{ac}}" bindinput="{{ad}}"/></view><view class="button-group"><button class="btn-secondary" bindtap="{{ae}}">上一步</button><button class="btn-save" bindtap="{{af}}">下一步：开始踏勘</button></view></view><view wx:if="{{ag}}"><view class="section-subtitle">踏勘信息</view><view class="form-group"><text class="cleaning-scope-title">清洗范围</text></view><view wx:if="{{ah}}" class="added-items-section"><view wx:for="{{ai}}" wx:for-item="item" wx:key="w" class="added-item"><view class="item-header"><text class="item-title">{{item.a}} ({{item.b}})</text><button class="remove-btn" bindtap="{{item.c}}">×</button></view><view class="item-specs"><view wx:if="{{item.d}}" class="spec-field"><text class="spec-label">具体位置 *</text><input class="spec-input" placeholder="请输入具体位置" value="{{item.e}}" bindinput="{{item.f}}"/></view><view class="spec-field"><text class="spec-label">型号规格 *</text><input class="spec-input" placeholder="请输入型号规格" value="{{item.g}}" bindinput="{{item.h}}"/></view><view class="spec-field"><text class="spec-label">单位 *</text><input class="spec-input" placeholder="请输入单位" readonly="{{item.i}}" value="{{item.j}}" bindinput="{{item.k}}"/></view><view class="spec-field"><text class="spec-label">数量 *</text><input class="spec-input" placeholder="请输入数量" type="number" value="{{item.l}}" bindinput="{{item.m}}"/></view><view class="spec-field"><text class="spec-label">作业频次 *</text><input class="spec-input" placeholder="请输入作业频次" value="{{item.n}}" bindinput="{{item.o}}"/></view><view wx:if="{{item.p}}" class="spec-field"><text class="spec-label">长度 *</text><input class="spec-input" placeholder="请输入长度" type="number" value="{{item.q}}" bindinput="{{item.r}}"/><text class="unit-indicator">米(m)</text></view><view class="spec-field"><text class="spec-label">拍照(清洗前) *</text><button class="photo-btn-add" bindtap="{{item.s}}">📷 添加照片</button><view wx:if="{{item.t}}" class="photo-preview-grid"><view wx:for="{{item.v}}" wx:for-item="photo" wx:key="c" class="photo-item"><image class="photo-image" src="{{photo.a}}" mode="aspectFill"></image><view class="photo-delete" bindtap="{{photo.b}}">×</view></view></view></view></view></view></view><view class="add-item-section"><view class="dropdown-container"><view class="dropdown-header" bindtap="{{ak}}"><text>添加清洗项目</text><text class="{{['dropdown-arrow', aj && 'rotated']}}">▼</text></view><view wx:if="{{al}}" class="dropdown-options"><view wx:for="{{am}}" wx:for-item="scope" wx:key="b" class="dropdown-option" bindtap="{{scope.c}}"><text>{{scope.a}}</text></view></view></view></view><view class="button-group"><button class="btn-secondary" bindtap="{{an}}">上一步</button><button class="btn-save" bindtap="{{ao}}">下一步：完成踏勘</button></view></view><view wx:if="{{ap}}"><view class="section-subtitle">踏勘完成</view><view class="completion-section"><view class="summary-section"><text class="summary-title">踏勘摘要</text><view class="summary-item"><text class="summary-label">名称：</text><text class="summary-value">{{aq}}</text></view><view class="summary-item"><text class="summary-label">地点：</text><text class="summary-value">{{ar}}</text></view><view class="summary-item"><text class="summary-label">踏勘人员：</text><text class="summary-value">{{as}}</text></view><view class="summary-item"><text class="summary-label">归属：</text><text class="summary-value">{{at}}</text></view><view class="summary-item"><text class="summary-label">清洗范围：</text><text class="summary-value">{{av}}</text></view></view><view class="document-generation"><text class="doc-title">文档生成</text><view wx:if="{{aw}}" class="doc-status"><text>正在生成踏勘报告...</text></view><view wx:else class="doc-actions"><button class="doc-btn" bindtap="{{ax}}">生成踏勘报告</button><button wx:if="{{ay}}" class="doc-btn" bindtap="{{az}}">预览报告</button></view></view></view><view class="button-group"><button class="btn-secondary" bindtap="{{aA}}">返回修改</button><button class="btn-save" bindtap="{{aB}}">保存并结束</button></view></view></view></view></view></view>