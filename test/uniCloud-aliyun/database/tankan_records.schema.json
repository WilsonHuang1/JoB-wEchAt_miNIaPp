{
    "bsonType": "object",
    "description": "踏勘记录表",
    "required": ["guishu", "tankanyuan", "mingcheng"],
    "permission": {
        ".read": true,
        ".create": true,
        ".update": "doc.userId == auth.uid",
        ".delete": "doc.userId == auth.uid"
    },
    "properties": {
        "_id": {
            "description": "记录ID，系统自动生成"
        },
        "guishu": {
            "bsonType": "string",
            "description": "归属公司",
            "label": "归属"
        },
        "tankanyuan": {
            "bsonType": "string",
            "description": "踏勘人员姓名",
            "label": "踏勘人员"
        },
        "didian": {
            "bsonType": "string",
            "description": "踏勘地点信息",
            "label": "地点"
        },
        "mingcheng": {
            "bsonType": "string",
            "description": "踏勘项目名称",
            "label": "名称"
        },
        "qingxifanwei": {
            "bsonType": "array",
            "description": "清洗范围详细信息数组（包含所有清洗项目的完整信息和照片）",
            "label": "清洗范围",
            "items": {
                "bsonType": "object",
                "properties": {
                    "type": {
                        "bsonType": "string",
                        "description": "清洗类型"
                    },
                    "position": {
                        "bsonType": "string",
                        "description": "具体位置"
                    },
                    "model": {
                        "bsonType": "string",
                        "description": "型号规格"
                    },
                    "unit": {
                        "bsonType": "string",
                        "description": "单位"
                    },
                    "quantity": {
                        "bsonType": "string",
                        "description": "数量"
                    },
                    "frequency": {
                        "bsonType": "string",
                        "description": "作业频次"
                    },
                    "length": {
                        "bsonType": "string",
                        "description": "长度（仅厨房烟罩）"
                    },
                    "photoBefore": {
                        "bsonType": "array",
                        "description": "清洗前照片云存储URL数组",
                        "items": {
                            "bsonType": "string"
                        }
                    }
                }
            }
        },
        "environmentData": {
            "bsonType": "object",
            "description": "环境信息",
            "label": "环境信息",
            "properties": {
                "parkingEntrance": {
                    "bsonType": "string",
                    "description": "停车场入口及价格",
                    "label": "停车场入口"
                },
                "recommendedParking": {
                    "bsonType": "string",
                    "description": "建议停车位",
                    "label": "建议停车位"
                },
                "elevatorEntrance": {
                    "bsonType": "string",
                    "description": "电梯入口",
                    "label": "电梯入口"
                },
                "recommendedRoute": {
                    "bsonType": "string",
                    "description": "建议路线",
                    "label": "建议路线"
                },
                "rooftopEnvironment": {
                    "bsonType": "string",
                    "description": "楼顶施工环境",
                    "label": "楼顶环境"
                },
                "waterElectricity": {
                    "bsonType": "string",
                    "description": "取水电情况",
                    "label": "水电情况"
                },
                "otherConditions": {
                    "bsonType": "string",
                    "description": "其他情况",
                    "label": "其他情况"
                }
            }
        },
        "multipleEntries": {
            "bsonType": "object",
            "description": "多条目数据（横管竖管）",
            "label": "多条目数据"
        },
        "summaryData": {
            "bsonType": "object",
            "description": "汇总统计数据",
            "label": "汇总数据"
        },
        "location": {
            "bsonType": "object",
            "description": "GPS位置信息",
            "properties": {
                "latitude": {
                    "bsonType": "double",
                    "description": "纬度"
                },
                "longitude": {
                    "bsonType": "double",
                    "description": "经度"
                },
                "address": {
                    "bsonType": "string",
                    "description": "地址描述"
                }
            }
        },
        "createTime": {
            "bsonType": "timestamp",
            "description": "创建时间",
            "forceDefaultValue": {
                "$env": "now"
            }
        },
        "userId": {
            "bsonType": "string",
            "description": "创建用户ID"
        },
        "status": {
            "bsonType": "string",
            "description": "记录状态",
            "default": "draft",
            "enum": ["draft", "submitted", "approved", "rejected"]
        }
    }
}