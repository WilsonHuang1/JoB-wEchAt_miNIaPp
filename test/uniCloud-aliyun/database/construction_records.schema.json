{
    "bsonType": "object",
    "description": "清洗工作记录表 - Cleaning Work Records",
    "required": ["workerName", "workerCompany", "selectedCleaningItems", "userId"],
    "permission": {
        ".read": true,
        ".create": true,
        ".update": "doc.userId == auth.uid",
        ".delete": "doc.userId == auth.uid"
    },
    "properties": {
        "_id": {
            "description": "记录ID，系统自动生成"
        },
        "workerName": {
            "bsonType": "string",
            "description": "施工人员姓名",
            "label": "施工人员"
        },
        "workerCompany": {
            "bsonType": "string",
            "description": "施工单位",
            "label": "施工单位"
        },
        "cleaningDate": {
            "bsonType": "timestamp",
            "description": "清洗日期",
            "label": "清洗日期"
        },
        "selectedCleaningItems": {
            "bsonType": "array",
            "description": "选择的清洗项目列表（支持同类型多项）",
            "label": "清洗项目",
            "items": {
                "bsonType": "object",
                "properties": {
                    "id": {
                        "bsonType": "string",
                        "description": "唯一标识ID"
                    },
                    "value": {
                        "bsonType": "string",
                        "description": "项目类型值 (kitchen/pipe/fan/purifier/custom_xxx)"
                    },
                    "label": {
                        "bsonType": "string",
                        "description": "项目显示名称"
                    }
                }
            }
        },
        "selectedSubOptions": {
            "bsonType": "object",
            "description": "每个项目选择的子选项（按项目ID组织）",
            "label": "子选项",
            "comment": "格式: { item_id_1: ['environment', 'stove'], item_id_2: ['pipe_leak'] }"
        },
        "sideNotes": {
            "bsonType": "object",
            "description": "每个项目的备注信息（按项目ID组织）",
            "label": "备注",
            "comment": "格式: { item_id_1: 'some notes', item_id_2: 'other notes' }"
        },
        "customOptionPhotos": {
            "bsonType": "object",
            "description": "自定义部位的照片（按before/after分类）",
            "label": "自定义部位照片",
            "properties": {
                "before": {
                    "bsonType": "object",
                    "description": "清洗前自定义部位照片",
                    "comment": "格式: { custom_123456: ['photo_url1', 'photo_url2'] }"
                },
                "after": {
                    "bsonType": "object",
                    "description": "清洗后自定义部位照片",
                    "comment": "格式: { custom_123456: ['photo_url1', 'photo_url2'] }"
                }
            }
        },
        "detailedBeforePhotos": {
            "bsonType": "object",
            "description": "清洗前详细照片，按项目ID和子选项分组",
            "label": "清洗前照片",
            "comment": "格式: { item_id: { environment: ['photo_url1'], stove: ['photo_url2'] } }"
        },
        "detailedAfterPhotos": {
            "bsonType": "object",
            "description": "清洗后详细照片，按项目ID和子选项分组",
            "label": "清洗后照片",
            "comment": "格式: { item_id: { environment: ['photo_url1'], stove: ['photo_url2'] } }"
        },
        "workPhotos": {
            "bsonType": "array",
            "description": "工作过程照片",
            "label": "工作照片",
            "items": {
                "bsonType": "string",
                "description": "照片URL"
            }
        },
        "environmentNotes": {
            "bsonType": "string",
            "description": "环境变更记录和特殊注意事项",
            "label": "环境备注"
        },
        "location": {
            "bsonType": "object",
            "description": "GPS位置信息（可选）",
            "properties": {
                "latitude": {
                    "bsonType": "double",
                    "description": "纬度"
                },
                "longitude": {
                    "bsonType": "double",
                    "description": "经度"
                },
                "address": {
                    "bsonType": "string",
                    "description": "地址描述"
                }
            }
        },
        "createTime": {
            "bsonType": "timestamp",
            "description": "创建时间",
            "forceDefaultValue": {
                "$env": "now"
            }
        },
        "updateTime": {
            "bsonType": "timestamp",
            "description": "更新时间"
        },
        "userId": {
            "bsonType": "string",
            "description": "创建用户ID",
            "label": "用户ID"
        },
        "status": {
            "bsonType": "string",
            "description": "记录状态",
            "enum": ["draft", "submitted", "completed", "verified"],
            "default": "submitted",
            "label": "状态"
        },
        "relatedInspectionId": {
            "bsonType": "string",
            "description": "关联的踏勘记录ID（如果基于踏勘）",
            "label": "关联踏勘ID"
        }
    }
}